<!doctype html>

<html class="no-js" lang="en">

<head>


	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

	BERNAT FERRAGUT

	Duet Theme by https://jekyllthemes.io
	Premium + free Jekyll themes for your blog or website.

	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->


	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<!-- Page Info -->
	<link rel="shortcut icon" href="/images/favicon.jpg">
	<title>100 STEPS: HACKING SCRATCH 3.0 – BERNAT FERRAGUT</title>
	<meta name="description" content="Blog post about code">

	<!-- Twitter Card -->
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:title" content="100 STEPS: HACKING SCRATCH 3.0 – BERNAT FERRAGUT">
	<meta name="twitter:description" content="Blog post about code">
	<meta name="twitter:image:src" content="http://localhost:4000/images/code/100/100steps.png">

	<!-- Facebook OpenGraph -->
	<meta property="og:title" content="100 STEPS: HACKING SCRATCH 3.0 – BERNAT FERRAGUT" />
	<meta property="og:description" content="Blog post about code" />
	<meta property="og:image" content="http://localhost:4000/images/code/100/100steps.png" />

	
	<!-- Font Embed Code -->
	<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Mono:400,700|Roboto:400,700&display=swap" rel="stylesheet">
	

	<!-- Styles -->
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="/css/style.css">
	
	<!-- Icons -->
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/solid.js" integrity="sha384-GXi56ipjsBwAe6v5X4xSrVNXGOmpdJYZEEh/0/GqJ3JTHsfDsF8v0YQvZCJYAiGu" crossorigin="anonymous"></script>
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/brands.js" integrity="sha384-0inRy4HkP0hJ038ZyfQ4vLl+F4POKbqnaUB6ewmU4dWP0ki8Q27A0VFiVRIpscvL" crossorigin="anonymous"></script>
	<script defer src="https://use.fontawesome.com/releases/v5.1.1/js/fontawesome.js" integrity="sha384-NY6PHjYLP2f+gL3uaVfqUZImmw71ArL9+Roi9o+I4+RBqArA2CfW1sJ1wkABFfPe" crossorigin="anonymous"></script>

	
	<!-- Custom Styles -->
	<style></style>
	

	
	<!-- Analytics Code -->
	
	

	
	<!-- Extra Header JS Code -->
	
	
	
</head>


<body class="loading ajax-loading" data-site-url="http://localhost:4000" data-page-url="/project/steps">


	<header class="header">

	<div class="wrap">

		
		<a href="/" class="header__title">
			BERNAT FERRAGUT
		</a>
		

		<div class="menu">
			<div class="menu__toggle js-menu-toggle">
				<div class="menu__toggle__icon"><span></span></div>
			</div>
			<div class="menu__wrap">
				<ul class="menu__list">
					
					<li class="menu__list__item">
						<a href="/" class="menu__list__item__link">design</a>
					</li>
					
					<li class="menu__list__item">
						<a href="/about" class="menu__list__item__link">bernat</a>
					</li>
					
					<li class="menu__list__item">
						<a href="/contact" class="menu__list__item__link">contact</a>
					</li>
					
				</ul>
			</div>
		</div>

	</div>

</header>


	<div class="loader"><svg width="120" height="30" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg"><circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="60" cy="15" r="9" fill-opacity="0.3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="0.5" to="0.5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle></svg></div>

	<div class="page-loader"></div>

	
	<div class="page">

		<div class="page__content" data-page-title="100 STEPS: HACKING SCRATCH 3.0 – BERNAT FERRAGUT">

			<section class="intro">

	<div class="wrap">

		<h1>100 STEPS: HACKING SCRATCH 3.0</h1>
		<p></p>

	</div>

</section>

<section class="single">

	<p><img src="/images/code/100/100steps.png" alt="" /></p>

<h1 id="hacking-scratch-30">Hacking Scratch 3.0</h1>

<p>In this article I explain in detail how to install the open source Scratch 3.0 software locally to be able to hack it at will. The tutorial is a step by step set of clear instructions which work well on my OSX Mojave mac laptop - Version 10.14.1.</p>

<p><a href="http://move100steps.surge.sh/">FOLLOW THIS LINK TO SEE THE LIVE VERSION</a></p>

<h2 id="structure">Structure</h2>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">scratch_mod</span>
    <span class="nx">scratch</span><span class="o">-</span><span class="nx">gui</span>
        <span class="nx">project</span><span class="p">.</span><span class="nx">json</span>
        <span class="nx">src</span>
        <span class="p">...</span>
    <span class="nx">scratch</span><span class="o">-</span><span class="nx">blocks</span>
        <span class="nx">project</span><span class="p">.</span><span class="nx">json</span>
        <span class="nx">src</span>
        <span class="p">...</span>
    <span class="nx">scratch</span><span class="o">-</span><span class="nx">vm</span>
        <span class="nx">project</span><span class="p">.</span><span class="nx">json</span>
        <span class="nx">src</span>
        <span class="p">...</span>
</code></pre></div></div>

<h2 id="components">Components</h2>

<ul>
  <li>Scratch GUI - The GUI for Scratch 3.</li>
  <li>Scratch Blocks - Allows you to add or remove blocks.</li>
  <li>Scratch VM - Allows you to add/change block functions.</li>
</ul>

<h2 id="scracth-30-installation-steps-for-mac-osx">Scracth 3.0 Installation steps for Mac OSX</h2>

<h3 id="pre-requisites">pre-requisites</h3>

<ol>
  <li>GitHub account with SSH key set up</li>
  <li>Node 8.x</li>
  <li>Copy Google closure library locally: ‘ln -s $(npm root)/google-closure-library ../closure-library’</li>
  <li>Open 3 Terminals on your VSCode to make your life easier</li>
</ol>

<h3 id="scratch-vm">scratch-vm</h3>

<ol>
  <li>fork LLK Repo: https://github.com/LLK/scratch-gui</li>
  <li>clone locally Repo: git clone https://github.com/[username]/scratch-gui</li>
  <li>git remote add upstream https://github.com/LLK/scratch-gui.git</li>
  <li>git config branch.develop.remote upstream (develop will be where you pull in changes from the official repo)</li>
  <li>git remote -v ( to confirm the connections are properly done )</li>
  <li>npm install - gets dependencies</li>
  <li>npm link (link the Repos )</li>
</ol>

<h3 id="scratch-blocks">scratch-blocks</h3>

<ol>
  <li>fork LLK Repo: https://github.com/LLK/scratch-blocks</li>
  <li>clone locally Repo: git clone https://github.com/bernatferragut/scratch-blocks</li>
  <li>git remote add upstream https://github.com/LLK/scratch-blocks.git</li>
  <li>git config branch.develop.remote upstream (develop will be where you pull in changes from the official repo)</li>
  <li>git remote -v ( to confirm the connections are properly done )</li>
  <li>npm install - gets dependencies</li>
  <li>npm link (link the Repos )</li>
  <li>npm run prepublish</li>
</ol>

<h3 id="scratch-gui">scratch-gui</h3>

<ol>
  <li>fork LLK Repo: https://github.com/LLK/scratch-gui</li>
  <li>clone locally Repo: git clone https://github.com/[username]/scratch-gui</li>
  <li>git remote add upstream https://github.com/LLK/scratch-gui.git</li>
  <li>git config branch.develop.remote upstream (develop will be where you pull in changes from the official repo)</li>
  <li>git remote -v ( to confirm the connections are properly done )</li>
  <li>npm install - gets dependencies</li>
  <li>npm start - starts local server which is hot reloaded</li>
  <li>open http://localhost:8601</li>
  <li>npm link scratch-blocks scratch-vm (last link the Repos )</li>
</ol>

<h2 id="creating-a-new-block-100-steps-block">Creating a new Block: ‘100 steps block’</h2>

<h3 id="scratch-blocks-1">scratch-blocks</h3>

<p>scratch-blocks/blocks_vertical folder/motion.js</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Blockly</span><span class="p">.</span><span class="nx">Blocks</span><span class="p">[</span><span class="s1">'motion_move100steps'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
  <span class="cm">/**
   * Block to move 100 steps.
   * @this Blockly.Block
   */</span>
  <span class="na">init</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">jsonInit</span><span class="p">({</span>
      <span class="s2">"message0"</span><span class="p">:</span> <span class="nx">Blockly</span><span class="p">.</span><span class="nx">Msg</span><span class="p">.</span><span class="nx">MOTION_MOVE100STEPS</span><span class="p">,</span>
      <span class="s2">"category"</span><span class="p">:</span> <span class="nx">Blockly</span><span class="p">.</span><span class="nx">Categories</span><span class="p">.</span><span class="nx">motion</span><span class="p">,</span>
      <span class="s2">"extensions"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"colours_motion"</span><span class="p">,</span> <span class="s2">"shape_statement"</span><span class="p">]</span>
    <span class="p">});</span>
  <span class="p">}</span>
<span class="p">};</span>
</code></pre></div></div>

<p>scratch-blocks/msg/messages.js</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">Blockly</span><span class="p">.</span><span class="nx">Msg</span><span class="p">.</span><span class="nx">MOTION_MOVE100STEPS</span> <span class="o">=</span> <span class="s1">'move 100 steps'</span><span class="p">;</span>
<span class="c1">// Place the block with other blocks from the category!</span>
</code></pre></div></div>

<h3 id="scratch-gui-1">scratch-gui</h3>

<p>scratch-gui/src/lib/make-toolbox-xml.js</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!--</span> <span class="nx">Move</span> <span class="mi">100</span> <span class="nx">Steps</span> <span class="nx">Block</span> <span class="o">--&gt;</span>
<span class="o">&lt;</span><span class="nx">block</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"motion_move10steps"</span> <span class="o">/&gt;</span>
<span class="c">&lt;!--</span> <span class="nx">Move</span> <span class="nx">X</span> <span class="nx">Steps</span> <span class="nx">Block</span> <span class="o">--&gt;</span>
<span class="o">&lt;</span><span class="nx">block</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"motion_movesteps"</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">value</span> <span class="nx">name</span><span class="o">=</span><span class="s2">"STEPS"</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="nx">shadow</span> <span class="nx">type</span><span class="o">=</span><span class="s2">"math_number"</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">field</span> <span class="nx">name</span><span class="o">=</span><span class="s2">"NUM"</span><span class="o">&gt;</span><span class="mi">100</span><span class="o">&lt;</span><span class="sr">/field</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/shadow</span><span class="err">&gt;
</span>  <span class="o">&lt;</span><span class="sr">/value</span><span class="err">&gt;
</span><span class="o">&lt;</span><span class="sr">/block</span><span class="err">&gt;
</span></code></pre></div></div>

<h3 id="scratch-blocks-2">scratch-blocks</h3>

<p><em>npm run prepublish</em></p>

<h3 id="scratch-vm-1">scratch-vm</h3>

<p>scratch-vm/src/blocks/scratch3_motion.js</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">scratch</span><span class="o">-</span><span class="nx">vm</span><span class="o">/</span><span class="nx">src</span><span class="o">/</span><span class="nx">blocks</span><span class="o">/</span><span class="nx">scratch3_motion</span><span class="p">.</span><span class="nx">js</span>
<span class="kd">class</span> <span class="nx">Scratch3MotionBlocks</span> <span class="p">{</span>
  <span class="nx">getPrimitives</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="na">motion_move100steps</span><span class="p">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">move100Steps</span><span class="p">,</span>
           <span class="c1">// Other Blocks</span>
        <span class="p">};</span>
    <span class="p">};</span>
    
    <span class="c1">// Other Functions</span>
    <span class="nx">move100Steps</span> <span class="p">(</span><span class="nx">args</span><span class="p">,</span> <span class="nx">util</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">steps</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
        <span class="kd">const</span> <span class="nx">radians</span> <span class="o">=</span> <span class="nx">MathUtil</span><span class="p">.</span><span class="nx">degToRad</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="nx">util</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">direction</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">dx</span> <span class="o">=</span> <span class="nx">steps</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">radians</span><span class="p">);</span>
        <span class="kd">const</span> <span class="nx">dy</span> <span class="o">=</span> <span class="nx">steps</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">radians</span><span class="p">);</span>
        <span class="nx">util</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">setXY</span><span class="p">(</span><span class="nx">util</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">x</span> <span class="o">+</span> <span class="nx">dx</span><span class="p">,</span> <span class="nx">util</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">y</span> <span class="o">+</span> <span class="nx">dy</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="relinking-everything">relinking everything</h3>

<p>sudo npm unlink ( gui, blocks, vm )</p>

<p>sudo npm link scratch-blocks scratch-vm</p>

<h3 id="scatch-gui">scatch-gui</h3>

<p>npm start - starts local server which is hot reloaded</p>

<p>open http://localhost:8601</p>

<h3 id="publishing">publishing</h3>

<p>npm run build
surge(for global storage)</p>

<p><img src="/images/code/100/100steps2.png" alt="" /></p>



</section>
			
		</div>

	</div>


	<footer class="footer">

	<div class="wrap">

		
		<a href="/" class="footer__title">
			BERNAT FERRAGUT
		</a>
		

		<p class="footer__text">Bernat Ferragut | COMPUTATIONAL DESIGN</p>

		<div class="footer__copyright">
			<span>© 2021 BERNAT FERRAGUT</span>
			<a href="https://jekyllthemes.io" target="_blank">Ipse domine lux mea est</a>
		</div>

		<ul class="socials">
	
	
	<li class="socials__item">
		<a href="https://github.com/bernatferragut" target="_blank" class="socials__item__link" title="Github">
			<i class="fab fa-github" aria-hidden="true"></i>
		</a>
	</li>
	
	
	
	<li class="socials__item">
		<a href="https://www.behance.net/bernatferragut" target="_blank" class="socials__item__link" title="Behance">
			<i class="fab fa-behance" aria-hidden="true"></i>
		</a>
	</li>
	
	
	
	<li class="socials__item">
		<a href="https://twitter.com/bernat_ferragut" target="_blank" class="socials__item__link" title="Twitter">
			<i class="fab fa-twitter" aria-hidden="true"></i>
		</a>
	</li>
	
	
	
	<li class="socials__item">
		<a href="https://www.linkedin.com/in/bernat-ferragut-a718b419/" target="_blank" class="socials__item__link" title="Linkedin">
			<i class="fab fa-linkedin" aria-hidden="true"></i>
		</a>
	</li>
	
	
</ul>

	</div>

</footer>


	<!-- Javascript Assets -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="/js/duet-min.js"></script>

	
	<!-- Extra Footer JS Code -->
	
	


</body>

</html>